# Медиатека - Практическая работа по ООП в Django

## Описание проекта

Проект "Медиатека" представляет собой веб-приложение для управления различными типами медиаконтента. В текущей реализации поддерживаются книги и аудиокниги, но система спроектирована для легкого расширения.

## Цель задания

**Добавить поддержку фильмов (Movie) в систему**, используя принципы объектно-ориентированного программирования и существующую архитектуру проекта.

## Архитектура проекта

### Принципы ООП в проекте

1. **Наследование** - иерархия классов медиа (`MediaItem` → `Book`, `AudioBook`)
2. **Полиморфизм** - переопределение методов `get_description()` в каждом классе
3. **Инкапсуляция** - защищенные атрибуты и методы
4. **Композиция** - использование миксинов для добавления функциональности

### Ключевые компоненты

#### Модели
- `MediaItem` - абстрактная базовая модель
- `Book` - класс для книг (использует `BorrowableMixin`)
- `AudioBook` - класс для аудиокниг (использует `BorrowableMixin` и `DownloadableMixin`)
- `Movie` - **НЕОБХОДИМО ДОБАВИТЬ**

#### Миксины
- `BorrowableMixin` - добавляет функциональность аренды
- `DownloadableMixin` - добавляет функциональность скачивания
- `ReviewableMixin` - добавляет функциональность отзывов

#### Фабрика
- `MediaFactory` - фабричный метод для создания объектов медиа

## Задание: Добавление класса Movie

### Шаг 1: Создание модели Movie

Создайте класс `Movie` в `models.py`, который должен:

- Наследоваться от `MediaItem`
- Использовать миксин `DownloadableMixin`
- Иметь специфичные поля:
  - `duration` (длительность в минутах)
  - `format` (формат видео)
  - `director` (режиссер)
- Переопределять метод `get_description()`
- Иметь уникальный метод `play_trailer()`

### Шаг 2: Обновление MediaFactory

Добавьте поддержку Movie в фабрику:

```python
# В services.py обновите словарь creators
creators = {
    'book': Book,
    'movie': Movie,  # Добавить эту строку
    'audiobook': AudioBook,
}
```

### Шаг 3: Обновление формы

В `forms.py` добавьте поля для Movie в класс `MediaForm`:

- Поле для длительности
- Поле для формата
- Поле для режиссера
- Соответствующую валидацию в методе `clean()`

### Шаг 4: Обновление диспетчеризации

В `views.py` обновите словарь `action_handlers` в функции `media_action()`:

```python
action_handlers = {
    # ... существующие обработчики ...
    'movie': {
        'describe': lambda obj: obj.get_description(),
        'play_trailer': lambda obj: obj.play_trailer(),
        'download': lambda obj: obj.download(),
    }
}
```

### Шаг 5: Обновление шаблонов

Шаблоны уже содержат закомментированные или частично готовые блоки для фильмов. Необходимо:

1. В `media_list.html` - раскомментировать и адаптировать секцию для фильмов
2. В `media_detail.html` - добавить отображение специфичных полей фильма
3. В `media_form.html` - добавить поля формы для фильма

### Шаг 6: Добавление тестов

Создайте тесты для класса Movie в `tests.py`:

- Тест создания объекта Movie
- Тест методов Movie
- Тест полиморфного поведения
- Тест использования миксинов

## Требования к реализации

### Для модели Movie
```python
class Movie(DownloadableMixin, MediaItem):
    duration = models.IntegerField(help_text="Длительность в минутах")
    format = models.CharField(max_length=10)
    director = models.CharField(max_length=100)
    
    def get_description(self):
        return f"Фильм '{self.title}' режиссера {self.director}"
    
    def play_trailer(self):
        return f"Воспроизведение трейлера фильма '{self.title}'"
```

### Для фабрики
```python
# В методе create_media класса MediaFactory
if media_type == 'movie':
    return Movie.objects.create(**kwargs)
```

### Для диспетчеризации действий
- describe - возвращает описание
- play_trailer - воспроизводит трейлер
- download - скачивает фильм

## Критерии оценки

1. **Корректность наследования** (3 балла)
   - Movie наследуется от MediaItem
   - Правильно использует миксины

2. **Полиморфное поведение** (2 балла)
   - Переопределение get_description()
   - Уникальный метод play_trailer()

3. **Интеграция с фабрикой** (2 балла)
   - Movie создается через MediaFactory
   - Правильная обработка в форме

4. **Диспетчеризация действий** (2 балла)
   - Правильная обработка действий для Movie
   - Соответствующие кнопки в интерфейсе

5. **Тестирование** (1 балл)
   - Написание корректных тестов

**Итого: 10 баллов**

## Дополнительные задания (по желанию)

1. Добавить поле `genre` (жанр) для Movie с выбором из предопределенных значений
2. Реализовать миксин `StreamableMixin` для возможности онлайн-просмотра
3. Добавить систему рейтингов для фильмов
4. Реализовать поиск по фильмам с фильтрацией по жанру и режиссеру

## Запуск проекта

1. Настройте venv и установите зависимости:
Linux/MacOS:
```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

Windows
```bash
py -m venv .venv
.venv/Scripts/activate
pip install -r reuirements.txt
```

2. Примените миграции:
```bash
python manage.py makemigrations
python manage.py migrate
```

3. Запустите сервер:
```bash
python manage.py runserver
```

4. Создайте несколько тестовых объектов через интерфейс

## Проверка работы

После реализации:

1. Убедитесь, что можно создать объект Movie через форму
2. Проверьте, что фабрика корректно создает Movie
3. Убедитесь, что кнопки "Смотреть трейлер" и "Скачать" работают
4. Проверьте полиморфное поведение - описание фильма отличается от книги
5. Запустите тесты и убедитесь, что они проходят
